<!DOCTYPE html>
<html>
	<head>
		<title>PWA demo</title>
		<link rel="manifest" href="manifest.json"/>
		<meta name="theme-color" content="#db5945"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
        <style>
            #curlCommand {
                height: 5em;
                margin: 1em 0;
                width: 100%;
            }
        </style>
		<script async src="js/pwa.bundle.js"></script>
    </head>
	<body>
        <div class="container" id="app">
            <div class="row">
                <div class="col-xs-12">
                    <h1>PWA demo</h1>

                    <experiment-warning v-bind:msg="message"></experiment-warning>

                    <div class="panel panel-default">
                        <!--<div class="panel-heading"></div>-->
                        <div class="panel-body">
                            <p>
                                This is a Progressive Web App test by <a href="http://mdworld.nl">mdworld.nl</a> including:
                            </p>
                            <ul>
                                <li><a href="https://developer.chrome.com/multidevice/android/installtohomescreen">Homescreen</a></li>
                                <li>ServiceWorker notification</li>
                                <li><em>@TODO</em> ServiceWorker CacheAPI</li>
                            </ul>
                            <a href="https://github.com/mdvanes/pwa-demo/"><span class="label label-primary">Sources on Github</span></a>
                            <a class="btn btn-primary btn-sm" href="https://mdworld-pwa-demo.herokuapp.com">Run on Heroku</a>
                        </div>
                    </div>

                    <p>
                        <a href="http://localhost:3000/sendUptime?send=true">http://localhost:3000/sendUptime?send=true</a>
                        <a id="subscribeLink" href="">http://localhost:3000/subscribe?key=</a>
                    </p>

                    <p>Visit on Github: https://github.com/mdvanes/pwa-demo/</p>
                    <p>This app runs on Heroku: https://mdworld-pwa-demo.herokuapp.com</p>

                    <p>
                        In Chrome 47 and later, a splash screen is displayed for a web application launched from a home screen. This splashscreen is auto-generated using properties in the web app manifest, specifically: name, background_color, and the icon in the icons array that is closest to 128dpi for the device.</p>

                    <p>
                        "display": "standalone",
                        The application will look and feel like a standalone application. This can include the application having a different window, its own icon in the application launcher, etc. In this mode, the user agent will exclude UI elements for controlling navigation, but can include other UI elements such as a status bar.</p>

                    <p>
                        background_color

                        Defines the expected background color for the web application. This value repeats what is already available in the application stylesheet, but can be used by browsers to draw the background color of a web application when the manifest is available before the style sheet has loaded. This creates a smooth transition between launching the web application and loading the application's content.
                    </p>

                    <p>
                        theme_color

                        Defines the default theme color for an application. This sometimes affects how the application is displayed by the OS (e.g., on Android's task switcher, the theme color surrounds the application).

                        Should work, but for now using the theme-color meta tag as a fallback.
                    </p>

                    <p style="word-break: break-all;">
                        Inspect/unregister: chrome://serviceworker-internals/

                        gcm_sender_id is for notifications, see https://developers.google.com/web/fundamentals/getting-started/codelabs/push-notifications/

                        https://android.googleapis.com/gcm/send/cxduDIcKfd4:APA91bHGhWaD4kcdECqMzHFXiULyn6SsORp3BMPHFZ14BrIP1mlnIZDSO4WE8QadKZnt8IsNQ7e-7fctH0okNDKh2W_blLaPoqEwTCza-j-bGUc1ZGY9dvUSRGTYPfakHkafa37dXjU6

                        Watch out: when getting MismatchSenderID after gcm_sender_id in manifest changed? Remove the "notifications" permission and reload and re-allow. Only then a new subscription_id is generated.

                        curl --header "Authorization: key=&lt;SERVER_API_KEY&gt;" --header "Content-Type: application/json" https://android.googleapis.com/gcm/send -d "{\"registration_ids\":[\"&lt;SUBSCRIPTION_ID&gt;\"]}"

                        On command line:
                        curl --header "Authorization: key=AIzaSyDLNHW-P0lk4yaVSTlVnYakexdW-fsAeC0" --header "Content-Type: application/json" https://android.googleapis.com/gcm/send -d "{\"registration_ids\":[\"cxduDIcKfd4:APA91bHGhWaD4kcdECqMzHFXiULyn6SsORp3BMPHFZ14BrIP1mlnIZDSO4WE8QadKZnt8IsNQ7e-7fctH0okNDKh2W_blLaPoqEwTCza-j-bGUc1ZGY9dvUSRGTYPfakHkafa37dXjU6\"]}"
                    </p>

                    <div id="currentSubscriptionKey" style="border: 1px solid red; word-break: break-all;"></div>

                    <div class="form-group">
                        <textarea id="curlCommand"></textarea>
                    </div>

                </div>
            </div>
        </div>


	</body>
</html>